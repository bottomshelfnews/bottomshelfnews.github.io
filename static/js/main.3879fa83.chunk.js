(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{39:function(e,t,n){e.exports=n(66)},62:function(e,t,n){},63:function(e,t,n){},66:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),r=n(23),o=n.n(r),i=n(7),u=n(16),l=n(24),c=n(10),m=n(2),p=n(3),h=n(22),f=n.n(h),b=(n(51),n(53),n(57),function(e){return{type:"LOGIN_ACTION",user:e}}),d=n(11),v=n.n(d),E={apiKey:"AIzaSyD9hWSw27OO_qk9eRKm2TMJ_09JcdeZdm8",authDomain:"bottomshelfnews.firebaseapp.com",databaseURL:"https://bottomshelfnews.firebaseio.com",projectId:"bottomshelfnews",storageBucket:"",messagingSenderId:"924993359943",appId:"1:924993359943:web:99b6abdc71d38c4316e162",measurementId:"G-LRJS1QWZZR"},g=function(){return(new Date).toJSON().slice(0,10)};g=function(){return"2020-01-08"};var y=function(){return new Date((new Date).setDate((new Date).getDate()-1)).toJSON().slice(0,10)},w=function(){function e(){var t=this;Object(m.a)(this,e),this.createUser=function(e,n,a){return t.auth.createUserWithEmailAndPassword(e,n).then(function(e){return e.user.updateProfile({displayName:a})})},this.login=function(e,n){if(!e||!n)return t.auth.signInAnonymously().then(function(e){return e.user}).then(function(e){return e.admin=!1,e});var a=null;return t.auth.signInWithEmailAndPassword(e,n).then(function(e){return(a=e.user).getIdTokenResult()}).then(function(e){return a.admin=e.claims.admin,console.log(a),a})},this.logOut=function(){return t.auth.signOut()},this.resetPass=function(e){return t.auth.sendPasswordResetEmail(e)},this.updatePass=function(e){return t.auth.currentUser.updatePassword(e)},this.newArticle=function(e,n,a,s){if(t.auth.currentUser){var r=t.db.ref("stories").push(),o=s?y():g();return r.set({title:e,url:n,category:a,date:o})}},this.newHeadline=function(e,n){if(t.auth.currentUser){var a=t.db.ref("submissions/").push().key,s=t.auth.currentUser.uid,r=t.auth.currentUser.displayName,o={};return o["/storysubmissions/"+e+"/"+a]={headline:n,user:s,username:r,votes:Object(c.a)({},s,!0),key:a},o["/storysubmissions/"+e+"/"+a]={headline:n,user:s,username:r,votes:Object(c.a)({},s,!0),key:a},o["/users/"+s+"/stories/"+e+"/submissions/"+a]=!0,o["/submissions/"+a]={headline:n,user:s,username:r,key:a,story:e},t.db.ref().update(o),a}},this.fakeVotes=function(e,n,a){for(var s=t.db.ref("items/"+e+"/submissions/"+n+"/votes"),r={},o=0;o<a;o++){var i=v.a.v4().substr(0,10),u=Math.random()>=.3;r[i]=u}s.update(r)},this.vote=function(e,n,a){if(t.auth.currentUser){var s=t.db.ref("storysubmissions/"+e+"/"+n+"/votes"),r=t.auth.currentUser.uid;s.update(Object(c.a)({},r,a))}},this.getTopPosts=function(){return t.db.ref("stories").orderByChild("date").equalTo(g()).once("value")},this.getSubmissionsByUser=function(e){return t.db.ref("users/"+e).once("value")},this.getSubmissionByID=function(e){return t.db.ref("/submissions/"+e).once("value")},this.getStorySubmissionByID=function(e){return t.db.ref("/storysubmissions/"+e).once("value")},this.getStoryByID=function(e){return t.db.ref("/stories/"+e).once("value")},this.getRecentTweets=function(e,n){var a={handle:e};return t.functions.httpsCallable("topNews")(a)},this.deleteStory=function(e){var n={};return n["stories/"+e]=null,n["storysubmissions/"+e]=null,console.log(n),t.getSubmissionsForPost(e).then(function(e){return e.val()}).then(function(a){for(var s in a){var r=a[s].user;n["submissions/"+s]=null,n["users/"+r+"/stories/"+e]=null}return console.log(n),t.db.ref().update(n)})},this.clearToday=function(){return t.getTopPosts().then(function(e){return e.val()}).then(function(e){return console.log(e),e}).then(function(e){return Object.keys(e||{})}).then(function(e){return Promise.all(e.map(t.deleteStory))})},f.a.initializeApp(E),this.auth=f.a.auth(),this.db=f.a.database(),this.functions=f.a.functions(),this.unsub=this.auth.onAuthStateChanged(function(e){e&&e.getIdTokenResult().then(function(t){e.admin=!!t.claims.admin,k.dispatch(b(e))}),t.unsub()})}return Object(p.a)(e,[{key:"email",value:function(){return this.auth.currentUser?this.auth.currentUser.email:null}},{key:"getSubmissionsForPost",value:function(e,t){return this.db.ref("storysubmissions/"+e).once("value")}},{key:"deleteSubmission",value:function(e,t,n){var a={};return a["storysubmissions/"+e+"/"+t]=null,a["submissions/"+t]=null,a["users/"+n+"/stories/"+e+"/submissions/"+t]=null,this.db.ref().update(a)}}]),e}();var O=function(e,t,n){var a=e.slice();return a.forEach(function(e){e.postID===t&&(console.log(e.headlines),e.headlines=e.headlines.filter(function(e){return e.key!==n}),console.log(e.headlines))}),a};var k=Object(l.b)(function(e,t){switch(t.type){case"LOGIN_ACTION":return Object(u.a)({},e,{user:t.user});case"LOGOUT_ACTION":return Object(u.a)({},e,{user:null,userID:null});case"GOT_POSTS_ACTION":return Object(u.a)({},e,{posts:t.data});case"DELETE_SUBMISSION_ACTION":return Object(u.a)({},e,{posts:O(e.posts,t.postID,t.subID)});case"DELETE_ACTION":return Object(u.a)({},e,{posts:e.posts.filter(function(e){return e.postID!==t.postID})});case"EDIT_ACTION":return console.log(e),Object(u.a)({},e,{posts:e.posts.map(function(e){return e.postID!==t.postID?e:Object(u.a)({},e,{title:t.newTitle,url:t.newURL})})});default:return e}},{user:null,posts:[],firebase:new w,categories:["general","sports","politics"]}),j=(n(62),n(5)),N=n(4),C=n(6),S=n(8),D=(n(63),n(18)),I=function(e){function t(){return Object(m.a)(this,t),Object(j.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(p.a)(t,[{key:"guestLogin",value:function(){var e=this;this.props.firebase.login(null,null).then(function(t){e.props.setLogin(t),e.props.history.push("/")})}},{key:"render",value:function(){return s.a.createElement("div",{className:"container-fluid landing"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-lg-6"},s.a.createElement("h3",null,"Bottom Shelf News is a crowd-sourced comedy news site!"),s.a.createElement("p",null,"The blue links are the titles of today's top news stories. The black headlines are our user's funniest alternatives. You can vote on your favorite submission, or write your own!"),s.a.createElement("p",null,"Bottom Shelf News is in development, This demo page provides a preview of it's core functionality. You can view ",s.a.createElement(S.b,{to:"/news"},"headlines and submissions")," now, or ",s.a.createElement(S.b,{to:"/login"},"Log In")," to vote and submit!"),s.a.createElement("p",null,"If you don't want to make an account, you can",s.a.createElement("button",{onClick:this.guestLogin.bind(this)},"continue as a guest"),". Guest accounts have full access to Bottom Shelf News features, but if you log out and return you won't be able to access the account again."),s.a.createElement("p",null,"Because this is a demo, you can also view an admin-only feature. To populate the site with daily articles, the ",s.a.createElement(S.b,{to:"/admin"}," admin control panel "),"allows privileged users to automatically fetch tweets from popular news accounts on Twitter and batch-submit them."),s.a.createElement("p",null,"Because you are (probably) not a bottomshelfnews.com administrator, you won't be able to actually submit the stories to the database, but you can view the functionality of the feature! Please ",s.a.createElement("button",{onClick:this.guestLogin.bind(this)},"log in as a guest")," before viewing the admin panel."))))}}]),t}(s.a.Component),T=Object(i.b)(function(e){return{firebase:e.firebase}},function(e){return{setLogin:function(t){return e(b(t))}}})(I),L=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(j.a)(this,Object(N.a)(t).call(this,e))).state={email:"",pass:"",error:null},n}return Object(C.a)(t,e),Object(p.a)(t,[{key:"submit",value:function(e){var t=this;e.preventDefault(),this.props.firebase.login(this.state.email,this.state.pass).then(function(e){t.setState({email:"",pass:""}),t.props.setLogin(e),t.props.history.push("/")}).catch(function(e){})}},{key:"change",value:function(e){this.setState(Object(c.a)({},e.target.name,e.target.value))}},{key:"guestLogin",value:function(){var e=this;this.props.firebase.login(null,null).then(function(t){e.props.setLogin(t),e.setState({email:"",pass:"",welcome:!0}),e.props.history.push("/")})}},{key:"render",value:function(){return s.a.createElement("form",{className:"form-group col-6",onSubmit:this.submit.bind(this)},s.a.createElement("label",null," Email: "),s.a.createElement("input",{name:"email",className:"form-control",value:this.state.email,onChange:this.change.bind(this)}),s.a.createElement("label",null," Password: "),s.a.createElement("input",{type:"password",name:"pass",className:"form-control",value:this.state.pass,onChange:this.change.bind(this)}),s.a.createElement("p",null),s.a.createElement("button",{className:"form-control"},"submit"),this.state.error?s.a.createElement("p",null,this.state.error.message):null,s.a.createElement("p",null,"Don't have an account? ",s.a.createElement(S.b,{to:"/signup"}," Sign Up! ")),s.a.createElement("button",{type:"button",className:"form-control",onClick:this.guestLogin.bind(this)},"Continue as Guest"))}}]),t}(s.a.Component),A=Object(i.b)(function(e){return Object(u.a)({},e)},function(e){return{setLogin:function(t){return e(b(t))}}})(L),P=Object(D.e)(A),x=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(j.a)(this,Object(N.a)(t).call(this,e))).state={email:"",pass:"",displayName:""},n}return Object(C.a)(t,e),Object(p.a)(t,[{key:"submit",value:function(e){var t=this;e.preventDefault(),console.log("submit"),console.log(this.props.firebase),this.props.firebase.createUser(this.state.email,this.state.pass,this.state.displayName).then(function(e){console.log("signup success"),t.setState({email:"",pass:"",error:null}),t.props.history.push("/home")}).catch(function(e){t.setState({error:e})})}},{key:"change",value:function(e){this.setState(Object(c.a)({},e.target.name,e.target.value))}},{key:"render",value:function(){return s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"row"},s.a.createElement("h3",{className:"col-sm-6 text-center"},"Register New Account")),s.a.createElement("form",{className:"form-group col-6",onSubmit:this.submit.bind(this)},s.a.createElement("label",null," Display Name: "),s.a.createElement("input",{name:"displayName",className:"form-control",value:this.state.displayName,onChange:this.change.bind(this)}),s.a.createElement("label",null," Email: "),s.a.createElement("input",{name:"email",className:"form-control",value:this.state.email,onChange:this.change.bind(this)}),s.a.createElement("label",null," Password: "),s.a.createElement("input",{type:"password",name:"pass",className:"form-control",value:this.state.pass,onChange:this.change.bind(this)}),s.a.createElement("p",null),s.a.createElement("button",{className:"form-control"},"submit")),this.state.error?s.a.createElement("div",null,s.a.createElement("h5",null,"error!"),this.state.error.message):null)}}]),t}(s.a.Component),U=Object(i.b)(function(e){return{firebase:e.firebase}})(Object(D.e)(x)),_=function(e){return{type:"GOT_POSTS_ACTION",data:e}},B=n(29),R=function(e){return{type:"DELETE_ACTION",postID:e}},F=function(e,t){return{type:"DELETE_SUBMISSION_ACTION",postID:e,subID:t}},G=function(e,t,n){return{type:"EDIT_ACTION",postID:e,newTitle:t,newURL:n}},M=function(e){function t(){var e,n;Object(m.a)(this,t);for(var a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return(n=Object(j.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(s)))).vote=function(e){n.props.firebase.vote(n.props.postID,n.props.rw.key,e),n.props.vote(e)},n}return Object(C.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=!!this.props.user,t=0;e&&!0===this.props.rw.votes[this.props.user.uid]?t=1:e&&!1===this.props.rw.votes[this.props.user.uid]&&(t=-1);var n=e&&this.props.user.uid===this.props.rw.user;return s.a.createElement("div",null,s.a.createElement("div",{className:"headlinebar"},s.a.createElement("span",null,"("+this.props.rw.score+")  "),s.a.createElement("span",null,this.props.rw.headline)),s.a.createElement("div",{className:"headlineinfo"},s.a.createElement(S.b,{to:"/user/"+this.props.rw.user},this.props.rw.username),e&&s.a.createElement("span",{style:{marginLeft:"4px"}},s.a.createElement("span",null,"Vote!"),this.buttons(t)),n&&s.a.createElement("span",{style:{marginLeft:"4px"}},s.a.createElement("button",{type:"button",onClick:this.delete.bind(this)},"delete"))))}},{key:"delete",value:function(){var e=this;this.props.firebase.deleteSubmission(this.props.postID,this.props.rw.key,this.props.rw.user).then(function(t){e.props.delete(e.props.rw.key)}).catch(function(e){return console.log("error:"+e)})}},{key:"buttons",value:function(e){var t=this;return 0===e?s.a.createElement("span",null,s.a.createElement("button",{onClick:function(){return t.vote(!0)},className:"vote-button"},"+"),s.a.createElement("button",{onClick:function(){return t.vote(!1)},className:"vote-button"},"-")):1===e?s.a.createElement("span",null,s.a.createElement("button",{onClick:function(){return t.vote(null)},className:"vote-button voted"},"+"),s.a.createElement("button",{onClick:function(){return t.vote(!1)},className:"vote-button"},"-")):s.a.createElement("span",null,s.a.createElement("button",{onClick:function(){return t.vote(!0)},className:"vote-button"},"+"),s.a.createElement("button",{onClick:function(){return t.vote(null)},className:"vote-button voted"},"-"))}}]),t}(s.a.Component),J=Object(i.b)(function(e){return{firebase:e.firebase,user:e.user}})(M),W=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(j.a)(this,Object(N.a)(t).call(this,e))).state={headlines:n.props.headlines.slice(0,n.props.show)},n}return Object(C.a)(t,e),Object(p.a)(t,[{key:"submit",value:function(e){if(e){var t=this.props.firebase.newHeadline(this.props.postID,e),n={headline:e,user:this.props.user.uid,username:this.props.user.displayName,key:t,score:1,votes:Object(c.a)({},this.props.user.uid,!0)};this.setState({headlines:this.state.headlines.concat([n])})}}},{key:"vote",value:function(e,t){for(var n=this.state.headlines.slice(0),a=0;a<this.state.headlines.length;a++)if(this.state.headlines[a].key===e){var s=this.state.headlines[a];s.votes[this.props.user.uid]=t;var r=Object.values(s.votes).reduce(function(e,t){return e+(!0===t?1:!1===t?-1:0)},0);s.score=r,n[a]=s}this.setState({headlines:n})}},{key:"delete",value:function(e){var t=this;this.props.firebase.deleteStory(e).then(function(){t.props.deleteSuccess(e),t.props.history.push("/news")})}},{key:"deleteSubmission",value:function(e){this.setState({headlines:this.state.headlines.filter(function(t){return t.key!==e})})}},{key:"render",value:function(){var e=this;return s.a.createElement("li",{className:"news-item"},s.a.createElement("p",null,s.a.createElement(S.b,{to:"/detail/"+this.props.postID,className:"original-title"},this.props.orTitle)),this.state.headlines.map(function(t){return s.a.createElement(J,{key:v.a.v4(),className:"best-rewrite",postID:e.props.postID,rw:t,vote:e.vote.bind(e,t.key),delete:e.deleteSubmission.bind(e)})}),this.props.user&&s.a.createElement(V,{submit:this.submit.bind(this)}),this.props.user&&this.props.user.admin&&s.a.createElement(H,{id:this.props.postID,delete:this.delete.bind(this)}))}}]),t}(s.a.Component),H=function(e){var t=Object(a.useState)(!1),n=Object(B.a)(t,2),r=n[0],o=n[1];return s.a.createElement("div",null,r?s.a.createElement("div",null,s.a.createElement("button",{type:"button",onClick:function(){return e.delete(e.id)}},"Confirm"),s.a.createElement("button",{type:"button",onClick:function(){return o(!1)}},"Cancel")):s.a.createElement("button",{type:"button",onClick:function(){return o(!0)}},"Delete Story"))},V=function(e){var t=Object(a.useState)(!1),n=Object(B.a)(t,2),r=n[0],o=n[1];return s.a.createElement("div",null,r?s.a.createElement(Z,{submit:e.submit,cancel:function(){return o(!1)}}):s.a.createElement("button",{onClick:function(){return o(!0)}},"New Submission"))},Z=function(e){var t=s.a.createRef();return s.a.createElement("div",null,s.a.createElement("fieldset",null,s.a.createElement("textarea",{ref:t,name:"title",style:{width:"80%",height:"2em"}})),s.a.createElement("button",{onClick:function(){e.submit(t.current.value),e.cancel()}},"Submit"),s.a.createElement("button",{onClick:e.cancel},"Cancel"))},q=Object(D.e)(Object(i.b)(function(e){return{firebase:e.firebase,user:e.user}},function(e){return{deleteSuccess:function(t){return e(R(t))},deleteSubmissionSuccess:function(t,n){return e(F(t,n))},editSuccess:function(t,n,a){return e(G(t,n,a))}}})(W)),z=function(e){return s.a.createElement("div",null,s.a.createElement("ul",{className:"links"},e.items.map(function(t){return s.a.createElement(q,{key:v.a.v4(),postID:t.postID,category:t.category,orTitle:t.title,timestamp:t.timestamp,headlines:t.headlines,show:e.show?e.show:4,url:t.url})})))},K=function(e){if(!e)return[];var t=Object.keys(e).map(function(t){var n=e[t];n.votes||(n.votes=[]);var a=Object.values(n.votes).reduce(function(e,t){return t?e+1:!1===t?e-1:e},0);return n.score=a,n.key=t,n});return t.sort(function(e,t){return t.score-e.score}),t},Y=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(j.a)(this,Object(N.a)(t).call(this,e))).state={submissions:null},n}return Object(C.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=null,n=null;this.props.firebase.getTopPosts().then(function(e){return e.val()}).then(function(a){if(a){t=a;var s=(n=Object.keys(a)).map(function(t){return e.props.firebase.getSubmissionsForPost(t)});return Promise.all(s)}}).then(function(e){return e.map(function(e){return e.val()})}).then(function(a){var s=a.map(function(e,t){return Object(c.a)({},n[t],e)}),r=n.map(function(e,n){var a=t[e];if(a.postID=e,s[n]){var r=s[n][Object.keys(s[n])[0]];a.headlines=K(r)}else a.headlines=[];return a});e.props.gotPosts(r)}).catch(function(t){console.log(t),e.props.gotPosts([])})}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("h2",null,"News Articles"),this.props.firebase.auth.currentUser?s.a.createElement("p",null,s.a.createElement(S.b,{to:"/new"},"Submit Article  ")):null,this.props.firebase.auth.currentUser?s.a.createElement("p",null,s.a.createElement(S.b,{to:"/admin"},"Admin Panel")):null,s.a.createElement(z,{items:this.props.posts}))}}]),t}(s.a.Component),Q=Object(i.b)(function(e){return{firebase:e.firebase,posts:e.posts}},function(e){return{gotPosts:function(t){e(_(t))}}})(Y),$=function(e){function t(){return Object(m.a)(this,t),Object(j.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"newspaper"},s.a.createElement("h1",null,"Bottom Shelf News"))}}]),t}(s.a.Component),X=function(e){function t(){return Object(m.a)(this,t),Object(j.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("h2",null,"News Articles"),s.a.createElement(z,{show_category:!0,items:this.props.posts}))}}]),t}(s.a.Component),ee=Object(i.b)(function(e){return{posts:e.posts}},function(e){return{gotPosts:function(t){return e(_(t))}}})(X),te=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(j.a)(this,Object(N.a)(t).call(this))).state={postsAndUserSubmissions:null},e}return Object(C.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.user;this.props.firebase.getSubmissionsByUser(t).then(function(e){return e.val()}).then(function(t){if(console.log(t),t&&t.stories){var n=t.stories,a=Object.keys(n),s=a.map(function(e){return Object.keys(n[e].submissions).map(function(t){return e+"/"+t})}).flat().map(function(t){return e.props.firebase.getStorySubmissionByID(t)});Promise.all(s).then(function(e){return e.map(function(e){var t=e.ref.path.toString().split("/");return[t[t.length-2],e.val()]})}).then(function(t){var n={};t.forEach(function(e){n[e[0]]?n[e[0]].push(e[1]):n[e[0]]=[e[1]]});var s=a.map(function(t){return e.props.firebase.getStoryByID(t)});Promise.all(s).then(function(e){return e.map(function(e){return[e.key,e.val()]})}).then(function(t){console.log(t);var a=[];t.forEach(function(e){var t=e[0],s=n[t];n[t]=e[1],n[t].headlines=K(s),n[t].postID=t,a.push(n[t])}),e.setState({postsAndUserSubmissions:a})})})}})}},{key:"render",value:function(){return this.state.postsAndUserSubmissions?s.a.createElement(z,{items:this.state.postsAndUserSubmissions,show:100}):s.a.createElement("div",null)}}]),t}(s.a.Component),ne=Object(i.b)(function(e){return{firebase:e.firebase}},function(e){return{gotPosts:function(t){return e(_(t))}}})(te),ae=[["OLD First","http://example.com","general"],["OLD Second","http://example.com","general"],["OLD Third one - Fake Post","http://example.com","general"],["OLD Fourth","http://example.com","general"],["OLD fifth","http://example.com","general"],["OLD kdlfjaklsdjfalksdjf","http://example.com","general"],["OLD djsfasdf","http://example.com","general"],["OLD A News Article","http://example.com","general"],["OLD ABC!","http://example.com","general"],["OLD hello ","http://example.com","general"],["OLD last one","http://example.com","general"]],se=function(e){return!0},re=function(e){function t(){var e,n;Object(m.a)(this,t);for(var a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return(n=Object(j.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(s)))).cancel=function(e){e.preventDefault(),n.props.history.push("/news")},n.submit=function(e){if(e.preventDefault(),e.target.url.value&&e.target.title.value){if(!se(e.target.url.value))return void console.log("invalid URL");var t=[e.target.title.value,e.target.url.value,e.target.category.value],a=t[0],s=t[1],r=t[2];n.props.firebase.newArticle(a,s,r),n.props.history.push("/news")}},n}return Object(C.a)(t,e),Object(p.a)(t,[{key:"fakeVotes",value:function(){var e=this;console.log("fake votes"),this.props.posts.forEach(function(t){console.log(t.submissions),t.submissions&&Object.keys(t.submissions).forEach(function(n){e.props.firebase.fakeVotes(t.postID,n,10)})})}},{key:"fakeSubs",value:function(){var e=this;console.log("fake subs"),this.props.posts.forEach(function(t){console.log(t),[1,2,3].forEach(function(n){return e.props.firebase.newHeadline(t.postID,"Fake Headline #"+n)})})}},{key:"fake_yesterday",value:function(){var e=this;ae.forEach(function(t){return e.props.firebase.newArticle(t[0],t[1],t[2],!0)}),this.props.history.push("/news")}},{key:"fake",value:function(){var e=this;ae.forEach(function(t){return e.props.firebase.newArticle(t[0],t[1],t[2])}),this.props.history.push("/news")}},{key:"render",value:function(){var e,t=this;return this.props.user?(e=this.props.params&&this.props.params.category?s.a.createElement("select",{name:"category"},s.a.createElement("option",{value:this.props.params.category},this.props.params.category),this.props.categories.filter(function(e){return e!==t.props.params.category}).map(function(e){return s.a.createElement("option",{key:v.a.v4(),value:e},e," ")})):s.a.createElement("select",{name:"category"},this.props.categories.map(function(e){return s.a.createElement("option",{key:v.a.v4(),value:e},e)})),s.a.createElement("div",{className:"new-post"},s.a.createElement("h2",null,"Submit a New Arcticle"),s.a.createElement("form",{autoComplete:"off",action:"",onSubmit:this.submit},s.a.createElement("fieldset",{className:"form-group wrap"},s.a.createElement("div",{className:"input-name"},"Title"),s.a.createElement("textarea",{className:"form-control",autoFocus:!0,name:"title",placeholder:"title"}),s.a.createElement("div",{className:"byline"},"Enter the original title of the article")),s.a.createElement("fieldset",{className:"form-group wrap"},s.a.createElement("div",{className:"input-name"},"URL"),s.a.createElement("textarea",{className:"form-control",name:"url",placeholder:"URL"}),s.a.createElement("div",{className:"byline"},"Please submit a link to a valid news source")),s.a.createElement("fieldset",{className:"form-group wrap"},s.a.createElement("div",{className:"input-name"},"Article Category"),e),s.a.createElement("div",{className:"new-post-buttons"},s.a.createElement("button",{type:"submit"},"Submit"),s.a.createElement("button",{onClick:this.cancel},"Cancel"))))):(this.props.history.push("/login"),null)}}]),t}(s.a.Component),oe=Object(D.e)(Object(i.b)(function(e){return{posts:e.posts,categories:e.categories,user:e.user,firebase:e.firebase}})(re)),ie=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(j.a)(this,Object(N.a)(t).call(this,e))).state={item:null},n}return Object(C.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.postID;Promise.all([this.props.firebase.getSubmissionsForPost(t,100),this.props.firebase.getStoryByID(t)]).then(function(t){var n=t[0].val(),a=t[1].val();a.headlines=n?K(n):[],console.log(a),e.setState({item:a})})}},{key:"render",value:function(){if(!this.state.item)return s.a.createElement("div",null,"hi");var e=this.state.item;return s.a.createElement("ul",null,s.a.createElement(q,{postID:this.props.match.params.postID,category:e.category,orTitle:e.title,timestamp:e.timestamp,headlines:e.headlines,show:100,url:e.url}))}}]),t}(s.a.Component),ue=Object(i.b)(function(e){return{firebase:e.firebase}})(ie),le=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(j.a)(this,Object(N.a)(t).call(this,e))).state={url:e.guess_url,title:e.guess_text},n}return Object(C.a)(t,e),Object(p.a)(t,[{key:"change",value:function(e){this.setState(Object(c.a)({},e.target.name,e.target.value))}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"adminPanel"},s.a.createElement("form",{autoComplete:"off",action:""},s.a.createElement("fieldset",{className:"form-group wrap "+this.props.status},s.a.createElement("div",{className:"input-name"},s.a.createElement("h2",null,this.props.full)),s.a.createElement("textarea",{spellCheck:!1,value:this.state.title,onChange:this.change.bind(this),className:"adminPanel",name:"title"}),s.a.createElement("textarea",{spellCheck:!1,className:"adminPanel",value:this.state.url,onChange:this.change.bind(this),name:"url"})),s.a.createElement("div",{className:"new-post-buttons"},s.a.createElement("button",{onClick:function(t){t.preventDefault(),e.props.cancel()}},"Cancel"),this.props.categories.map(function(t){return s.a.createElement("button",{key:v.a.v4(),type:"button",onClick:function(n){n.preventDefault(),e.props.save(t,e.state.url,e.state.title)}},t)}))))}}]),t}(s.a.Component),ce="bg1",me="bg2",pe="bg3",he=function(e){return s.a.createElement("div",{className:"tweetpreview"},s.a.createElement("p",null,s.a.createElement("strong",null,e.tweet.cat)),s.a.createElement("p",null,e.tweet.title),s.a.createElement("p",null,s.a.createElement("a",{href:e.tweet.url},e.tweet.url)))},fe=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(j.a)(this,Object(N.a)(t).call(this,e))).state={handle:"",tweets:null,to_submit:[],submitting:!1},n}return Object(C.a)(t,e),Object(p.a)(t,[{key:"fetchTweets",value:function(e,t){var n=this,a=function(e){return e.favorite_count};this.props.firebase.getRecentTweets(e,t).then(function(e){return e.data}).then(function(e){return e.sort(function(e,t){return a(t)-a(e)})}).then(function(e){e.forEach(function(e){e.status=ce,e.id=v.a.v4()}),n.setState({tweets:e})})}},{key:"fetchCustomTweets",value:function(e){e.preventDefault(),this.fetchTweets(this.state.handle,50)}},{key:"handleChange",value:function(e){this.setState({handle:e.target.value})}},{key:"cancel",value:function(e){var t=this.state.tweets;(t=t.slice()).forEach(function(t){t.id===e&&(t.status=pe)}),this.setState({tweets:t})}},{key:"save",value:function(e,t,n,a){var s=this.state.tweets;(s=s.slice()).forEach(function(s){s.id===e&&(s.url=n,s.title=a,s.cat=t,s.status=me)}),this.setState({tweets:s})}},{key:"submit",value:function(e){var t=this;e.preventDefault(),this.state.tweets.forEach(function(e){e.status===me&&t.props.firebase.newArticle(e.title,e.url,e.cat,!1).then(function(e){return t.props.history.push("/news")})})}},{key:"show",value:function(e){this.setState({submitting:!this.state.submitting})}},{key:"killDB",value:function(){var e=this;this.props.firebase.clearToday().then(function(t){e.props.history.push("/news")})}},{key:"render",value:function(){var e=this,t=["general","sports","politics"];return this.state.submitting?s.a.createElement("div",null,s.a.createElement("button",{style:{margin:"10px"},onClick:function(){return e.props.history.push("/news")}},"Cancel"),s.a.createElement("button",{onClick:this.submit.bind(this)},"submit"),s.a.createElement("button",{onClick:this.show.bind(this)},"edit"),this.state.tweets.filter(function(e){return e.status===me}).map(function(e){return s.a.createElement(he,{tweet:e,key:v.a.v4()})})):this.state.tweets?s.a.createElement("div",null,s.a.createElement("button",{style:{margin:"10px"},onClick:function(){return e.props.history.push("/news")}},"Cancel"),s.a.createElement("button",{style:{margin:"10px"},onClick:function(){return e.setState({tweets:null})}},"Clear"),s.a.createElement("button",{onClick:this.show.bind(this)},"show selections"),s.a.createElement("button",{onClick:this.killDB.bind(this)},"kill database"),this.state.tweets.map(function(n){return s.a.createElement(le,{categories:t,full:n.full_text,guess_url:n.guess_url,guess_text:n.guess_text,status:n.status,save:e.save.bind(e,n.id),cancel:e.cancel.bind(e,n.id),key:n.id})})):s.a.createElement("div",null,s.a.createElement("form",{onSubmit:this.fetchCustomTweets.bind(this)},s.a.createElement("button",{style:{margin:"10px"},onClick:function(){return e.props.history.push("/news")}},"Cancel"),s.a.createElement("button",{type:"button",style:{margin:"10px"},onClick:function(){return e.fetchTweets("ap",50)}},"Fetch AP Tweets"),s.a.createElement("button",{type:"button",style:{margin:"10px"},onClick:function(){return e.fetchTweets("abc",50)}},"Fetch ABC News Tweets"),s.a.createElement("input",{type:"text",placeholder:"@handle",value:this.state.handle,onChange:this.handleChange.bind(this)}),s.a.createElement("button",{type:"submit"},"Fetch Custom Tweets")),s.a.createElement("button",{style:{margin:"10px"},onClick:this.killDB.bind(this)},"kill database"))}}]),t}(s.a.Component),be=Object(D.e)(Object(i.b)(function(e){return{posts:e.posts,categories:e.categories,user:e.user,firebase:e.firebase}})(fe));var de=Object(i.b)(function(e,t){return{firebase:e.firebase,user:e.user,uid:e.user?e.user.uid:null}},function(e){return{doLogout:function(){return e({type:"LOGOUT_ACTION"})}}})(function(e){return window.u=e.user,s.a.createElement("div",{className:"top"},s.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark"},s.a.createElement("ul",{className:"nav navbar-nav"},s.a.createElement("li",null,s.a.createElement(S.b,{to:"/"},s.a.createElement("button",{className:"btn btn-primary"},"Home"))),s.a.createElement("li",null,s.a.createElement(S.b,{to:"/news"},s.a.createElement("button",{className:"btn btn-primary"},"News")),!1),e.user?s.a.createElement("li",null,s.a.createElement(S.b,{to:"/user/"+e.uid},s.a.createElement("button",{className:"btn btn-primary"},"Profile"))):s.a.createElement("li",null,s.a.createElement(S.b,{to:"/login"},s.a.createElement("button",{className:"btn btn-primary"},"Log In")))),s.a.createElement("ul",{className:"nav navbar-nav ml-auto"},e.user&&s.a.createElement("li",null,s.a.createElement("span",{className:"navbar-text"},e.user.displayName||"anonymous")),e.user?s.a.createElement("li",null,s.a.createElement("button",{className:"btn btn-primary float-right",onClick:function(){e.firebase.logOut(),e.doLogout()}},"Log Out")):s.a.createElement("li",null,s.a.createElement(S.b,{to:"/signup"},s.a.createElement("button",{className:"btn btn-primary"},"Sign Up"))))),s.a.createElement(D.a,{exact:!0,path:"/",component:T}),s.a.createElement(D.a,{path:"/news",component:Q}),s.a.createElement(D.a,{path:"/newspaper",component:$}),s.a.createElement(D.a,{path:"/login",component:P}),s.a.createElement(D.a,{path:"/signup",component:U}),s.a.createElement(D.a,{path:"/detail/:postID",component:ue}),s.a.createElement(D.a,{path:"/category/:category",component:ee}),s.a.createElement(D.a,{path:"/user/:user",component:ne}),s.a.createElement(D.a,{path:"/new",component:oe}),s.a.createElement(D.a,{path:"/admin",component:be}))}),ve=function(e){function t(){return Object(m.a)(this,t),Object(j.a)(this,Object(N.a)(t).apply(this,arguments))}return Object(C.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return s.a.createElement(S.a,null,s.a.createElement(de,null))}}]),t}(s.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(65);o.a.render(s.a.createElement(i.a,{store:k},s.a.createElement(ve,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[39,1,2]]]);
//# sourceMappingURL=main.3879fa83.chunk.js.map